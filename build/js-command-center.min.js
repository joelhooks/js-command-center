var jscc=jscc||{},Hashtable=function(){function a(b){var c;if("string"==typeof b)return b;if(typeof b.hashCode==k)return c=b.hashCode(),"string"==typeof c?c:a(c);if(typeof b.toString==k)return b.toString();try{return String(b)}catch(d){return Object.prototype.toString.call(b)}}function b(a,b){return a.equals(b)}function c(a,b){return typeof b.equals==k?b.equals(a):a===b}function d(){return function(a){return null===a?!1:"undefined"==typeof a?!1:!0}}function e(a,b,c,d){this[0]=a,this.entries=[],this.addEntry(b,c),null!==d&&(this.getEqualityFunction=function(){return d})}function f(a){return function(b){for(var c,d=this.entries.length,e=this.getEqualityFunction(b);d--;)if(c=this.entries[d],e(b,c[0]))switch(a){case o:return!0;case p:return c;case q:return[d,c[1]]}return!1}}function g(a){return function(b){for(var c=b.length,d=0,e=this.entries.length;e>d;++d)b[c+d]=this.entries[d][a]}}function h(a,b){for(var c,d=a.length;d--;)if(c=a[d],b===c[0])return d;return null}function i(a,b){var c=a[b];return c&&c instanceof e?c:null}function j(b,c){var d=this,f=[],g={},o=typeof b==k?b:a,p=typeof c==k?c:null;this.put=function(a,b){var c,d,h,j=m(a),k=null;return j===!1?null:(n(b),c=o(a),d=i(g,c),d?(h=d.getEntryForKey(a),h?(k=h[1],h[1]=b):d.addEntry(a,b)):(d=new e(c,a,b,p),f[f.length]=d,g[c]=d),k)},this.get=function(a){var b,c=m(a);if(c===!1)return null;b=o(a);var d=i(g,b);if(d){var e=d.getEntryForKey(a);if(e)return e[1]}return null},this.containsKey=function(a){var b,c=m(a);if(c===!1)return!1;b=o(a);var d=i(g,b);return d?d.containsKey(a):!1},this.containsValue=function(a){if(void 0===a||null===a)return!1;n(a);for(var b=f.length;b--;)if(f[b].containsValue(a))return!0;return!1},this.clear=function(){f.length=0,g={}},this.isEmpty=function(){return!f.length};var q=function(a){return function(){for(var b=[],c=f.length;c--;)f[c][a](b);return b}};this.keys=q("keys"),this.values=q("values"),this.entries=q("getEntries"),this.remove=function(a){var b,c,d=m(a),e=null;if(d===!1)return null;b=o(a);var j=i(g,b);return j&&(e=j.removeEntryForKey(a),null!==e&&(j.entries.length||(c=h(f,b),l(f,c),delete g[b]))),e},this.size=function(){for(var a=0,b=f.length;b--;)a+=f[b].entries.length;return a},this.each=function(a){for(var b,c=d.entries(),e=c.length;e--;)b=c[e],a(b[0],b[1])},this.putAll=function(a,b){for(var c,e,f,g,h=a.entries(),i=h.length,j=typeof b==k;i--;)c=h[i],e=c[0],f=c[1],j&&(g=d.get(e))&&(f=b(e,g,f)),d.put(e,f)},this.clone=function(){var a=new j(b,c);return a.putAll(d),a}}var k="function",l=typeof Array.prototype.splice==k?function(a,b){a.splice(b,1)}:function(a,b){var c,d,e;if(b===a.length-1)a.length=b;else for(c=a.slice(b+1),a.length=b,d=0,e=c.length;e>d;++d)a[b+d]=c[d]},m=d("key"),n=d("value"),o=0,p=1,q=2;return e.prototype={getEqualityFunction:function(a){return typeof a.equals==k?b:c},getEntryForKey:f(p),getEntryAndIndexForKey:f(q),removeEntryForKey:function(a){var b=this.getEntryAndIndexForKey(a);return b?(l(this.entries,b[0]),b[1]):null},addEntry:function(a,b){this.entries[this.entries.length]=[a,b]},keys:g(0),values:g(1),getEntries:function(a){for(var b=a.length,c=0,d=this.entries.length;d>c;++c)a[b+c]=this.entries[c].slice(0)},containsKey:f(o),containsValue:function(a){for(var b=this.entries.length;b--;)if(a===this.entries[b][1])return!0;return!1}},j}(),EventDispatcher;!function(){"use strict";EventDispatcher=function(){var a={};this.addEventListener=function(b,c,d){a.hasOwnProperty(b)?a[b].push([c,d]):a[b]=[[c,d]]},this.removeEventListener=function(b,c){var d;if(a.hasOwnProperty(b))for(d in a[b])if(a[b][d][0]==c)return a[b].splice(d,1),!0;return!1},this.dispatchEvent=function(b){var c;if(b&&a.hasOwnProperty(b))for(c in a[b])"function"==typeof a[b][c][0]&&a[b][c][0].call(a[b][c][1],event)}}}(),function(){"use strict";angular.module("AngularCommandExecutor",[]).factory("AngularCommandExecutor",function(a,b){return jscc.AngularCommandExecutor=function(c,d){this.execute=function(e,f){for(var g,h=d.head;h;)g=a.instantiate(h.commandConstructor,{params:f,event:e}),g.dispatch=b.dispatchEvent,g&&(h.fireOnce&&c.removeMapping(h),g.execute.hasOwnProperty("$inject")||(g.execute.$inject=["params"]),a.invoke(g.execute,g,{params:f,event:e}),g.destroy&&g.autoDestroy()&&g.destroy(),g.dispatch=null),h=h.next}},AngularCommandExecutor})}(),function(){"use strict";angular.module("command-map",[]).factory("commandMap",function(a,b){return jscc.AngularCommandMap=function(a){var c,d=new Hashtable;this.map=function(b){if("undefined"==typeof b)throw new Error("cannot map undefined.");var e=d.get(b);return e||(e=c(b),d.put(b,e)),a.map(e)},this.unmap=function(b){var c=d.get(b);return a.unmap(c)},c=function(a){return new b(a)}},new AngularCommandMap(new jscc.CommandCenter)})}(),function(){"use strict";angular.module("AngularCommandTrigger",[]).factory("AngularCommandTrigger",function(a,b){return jscc.AngularCommandTrigger=function(c){var d,e,f,g=new jscc.CommandMappingList,h=new b(this,g);this.addMapping=function(a){d(a),g.head||e(),g.add(a)},this.removeMapping=function(a){g.remove(a),g.head||f()},d=function(a){var b=a.commandConstructor.prototype.execute;if(!b)throw new Error("No execute() method on CommandMapping")},e=function(){a.addEventListener(c,h.execute)},f=function(){a.removeEventListener(c,h.execute)}},AngularCommandTrigger})}(),function(){"use strict";angular.module("AngularEventDispatcher",[]).factory("dispatcher",function(a){return new a}).factory("AngularEventDispatcher",function(a){return jscc.AngularEventDispatcher=function(){var b={};this.addEventListener=function(c){var d=Array.prototype.slice.call(arguments);return"function"==typeof b[c]&&b[c].call(),b[c]=a.$on.apply(a,d),b[c]},this.removeEventListener=function(a){return b[a]?(b[a].call(),delete b[a],!0):!1},this.dispatchEvent=a.$emit.bind(a)},AngularEventDispatcher})}(),function(){"use strict";jscc.CommandCenter=function(){var a=new Hashtable,b={fromCommand:function(){},fromAll:function(){}};this.map=function(b){var c=a.get(b);return c||(a.put(b,new jscc.CommandMapper(b)),c=a.get(b)),c},this.unmap=function(c){var d=a.get(c);return d?d:b}}}(),function(){"use strict";jscc.CommandMapper=function(a){var b,c,d,e=new Hashtable;this.toCommand=function(a){if("undefined"==typeof a)throw new Error("cannot map event to undefined.");var c;return e.containsKey(a)&&(c=e.get(a)),c?d(c):b(a)},this.fromCommand=function(a){var b=e.get(a);b&&c(b)},this.fromAll=function(){e.each(function(a,b){c(b)})},b=function(b){var c=new jscc.CommandMapping(b);return a.addMapping(c),e.put(b,c),c},c=function(b){a.removeMapping(b),e.remove(b.commandConstructor)},d=function(a){return c(a),b(a.commandConstructor)}}}(),function(){"use strict";jscc.CommandMapping=function(a){this.commandConstructor=a,this.fireOnce=!1,this.once=function(a){return void 0===a&&(a=!0),this.fireOnce=a,this}}}(),function(){"use strict";jscc.CommandMappingList=function(){this.head=null,this.tail=null,this.add=function(a){this.tail?(this.tail.next=a,a.previous=this.tail,this.tail=a):this.head=this.tail=a},this.remove=function(a){a===this.head&&(this.head=this.head.next),a===this.tail&&(this.tail=this.tail.previous),a.previous&&(a.previous.next=a.next),a.next&&(a.next.previous=a.previous)}}}(),function(){"use strict";jscc.EventCommandExecutor=function(a,b){this.execute=function(){for(var c,d=b.head;d;)c=new d.commandConstructor,c&&(d.fireOnce&&a.removeMapping(d),c.execute()),d=d.next}}}(),function(){"use strict";jscc.EventCommandMap=function(a,b,c){var d,e=new Hashtable;this.map=function(a){var b=e.get(a);return b||(b=d(a),e.put(a,b)),c.map(b)},d=function(c){return new jscc.EventCommandTrigger(a,b,c)}}}(),function(){"use strict";jscc.EventCommandTrigger=function(a,b,c){var d,e,f,g=new jscc.CommandMappingList,h=new jscc.EventCommandExecutor(this,g,a);this.addMapping=function(a){d(a),g.head||e(),g.add(a)},this.removeMapping=function(a){g.remove(a),g.head||f()},d=function(a){var b=a.commandConstructor.prototype.execute;if(!b)throw new Error("No execute() method on CommandMapping")},e=function(){b.addEventListener(c,h.execute)},f=function(){b.removeEventListener(c,h.execute)}}}();